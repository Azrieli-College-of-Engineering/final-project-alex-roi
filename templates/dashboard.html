<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard — NexusCloud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .sidebar-link { transition: all 0.15s; }
        .sidebar-link:hover { background: rgba(255,255,255,0.06); }
        .sidebar-link.active { background: rgba(255,255,255,0.08); color: #fff; }
        .toast-enter { animation: toastIn 0.3s ease-out; }
        .toast-exit { animation: toastOut 0.3s ease-in forwards; }
        @keyframes toastIn { from { opacity: 0; transform: translateY(-8px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
        @keyframes toastOut { from { opacity: 1; transform: translateY(0) scale(1); } to { opacity: 0; transform: translateY(-8px) scale(0.95); } }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .upgrade-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .stat-card { transition: all 0.3s; }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        .balance-negative { color: #ef4444 !important; }
        .balance-warning { color: #f59e0b !important; }
        .balance-ok { color: #10b981 !important; }
    </style>
</head>
<body class="bg-gray-950 text-gray-300 antialiased">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 flex flex-col gap-2"></div>

    <!-- Sidebar -->
    <aside class="fixed left-0 top-0 h-full w-64 bg-gray-900 border-r border-gray-800 flex flex-col z-40">
        <!-- Logo -->
        <div class="px-6 py-5 border-b border-gray-800">
            <a href="/" class="flex items-center gap-2.5">
                <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                </div>
                <span class="text-lg font-bold text-white">NexusCloud</span>
            </a>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 px-3 py-4 space-y-1">
            <button onclick="switchTab('overview')" data-tab="overview" class="sidebar-link active w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-gray-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"/></svg>
                Overview
            </button>
            <button onclick="switchTab('team')" data-tab="team" class="sidebar-link w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-gray-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>
                Team Members
            </button>
            <button onclick="switchTab('billing')" data-tab="billing" class="sidebar-link w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-gray-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z"/></svg>
                Billing
            </button>
            <button onclick="switchTab('activity')" data-tab="activity" class="sidebar-link w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-gray-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                Activity Log
            </button>

            <div class="pt-4 mt-4 border-t border-gray-800">
                <button onclick="switchTab('settings')" data-tab="settings" class="sidebar-link w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-gray-400">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                    Settings
                </button>
            </div>
        </nav>

        <!-- User Section -->
        <div class="px-4 py-4 border-t border-gray-800">
            <div class="flex items-center gap-3">
                <div class="w-9 h-9 rounded-full bg-indigo-600 flex items-center justify-center text-white text-sm font-bold">A</div>
                <div class="flex-1 min-w-0">
                    <div class="text-sm font-medium text-white truncate">Admin</div>
                    <div class="text-xs text-gray-500 truncate">admin@nexuscloud.io</div>
                </div>
                <a href="/" class="text-gray-500 hover:text-gray-300 transition">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"/></svg>
                </a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="ml-64 min-h-screen">
        <!-- Top Bar -->
        <header class="sticky top-0 bg-gray-950/80 backdrop-blur-xl border-b border-gray-800 px-8 py-4 z-30">
            <div class="flex items-center justify-between">
                <div>
                    <h1 id="page-title" class="text-xl font-semibold text-white">Overview</h1>
                    <p id="page-subtitle" class="text-sm text-gray-500">Monitor your team and account in real-time</p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="relative">
                        <input type="text" placeholder="Search..." class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm w-64 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500/20 outline-none transition placeholder-gray-500">
                        <svg class="w-4 h-4 text-gray-500 absolute right-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                    </div>
                    <button class="relative p-2 text-gray-400 hover:text-white transition rounded-lg hover:bg-gray-800">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"/></svg>
                        <span class="absolute top-1.5 right-1.5 w-2 h-2 bg-indigo-500 rounded-full"></span>
                    </button>
                </div>
            </div>
        </header>

        <div class="p-8">
            <!-- ==================== OVERVIEW TAB ==================== -->
            <div id="tab-overview" class="tab-content fade-in">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="stat-card bg-gray-900 rounded-xl p-6 border border-gray-800">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm text-gray-500">Account Credits</span>
                            <div class="w-10 h-10 rounded-lg bg-emerald-500/10 flex items-center justify-center">
                                <svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            </div>
                        </div>
                        <div id="credits-balance" class="text-3xl font-bold text-white balance-ok">$100</div>
                        <p class="text-xs text-gray-500 mt-1">Available balance</p>
                    </div>

                    <div class="stat-card bg-gray-900 rounded-xl p-6 border border-gray-800">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm text-gray-500">Team Members</span>
                            <div class="w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center">
                                <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>
                            </div>
                        </div>
                        <div id="total-members" class="text-3xl font-bold text-white">5</div>
                        <p class="text-xs text-gray-500 mt-1">Total members</p>
                    </div>

                    <div class="stat-card bg-gray-900 rounded-xl p-6 border border-gray-800">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm text-gray-500">Pro Users</span>
                            <div class="w-10 h-10 rounded-lg bg-amber-500/10 flex items-center justify-center">
                                <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"/></svg>
                            </div>
                        </div>
                        <div id="pro-count" class="text-3xl font-bold text-amber-400">0</div>
                        <p class="text-xs text-gray-500 mt-1">Premium seats</p>
                    </div>

                    <div class="stat-card bg-gray-900 rounded-xl p-6 border border-gray-800">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm text-gray-500">Starter Users</span>
                            <div class="w-10 h-10 rounded-lg bg-gray-500/10 flex items-center justify-center">
                                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"/></svg>
                            </div>
                        </div>
                        <div id="free-count" class="text-3xl font-bold text-white">5</div>
                        <p class="text-xs text-gray-500 mt-1">Free tier seats</p>
                    </div>
                </div>

                <!-- Team Preview + Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Team Preview -->
                    <div class="lg:col-span-2 bg-gray-900 rounded-xl border border-gray-800">
                        <div class="px-6 py-4 border-b border-gray-800 flex items-center justify-between">
                            <h2 class="text-base font-semibold text-white">Team Members</h2>
                            <button onclick="switchTab('team')" class="text-sm text-indigo-400 hover:text-indigo-300 transition">View all →</button>
                        </div>
                        <div id="team-preview" class="divide-y divide-gray-800">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800">
                        <div class="px-6 py-4 border-b border-gray-800 flex items-center justify-between">
                            <h2 class="text-base font-semibold text-white">Recent Activity</h2>
                            <button onclick="switchTab('activity')" class="text-sm text-indigo-400 hover:text-indigo-300 transition">View all →</button>
                        </div>
                        <div id="activity-preview" class="divide-y divide-gray-800 max-h-96 overflow-y-auto">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== TEAM TAB ==================== -->
            <div id="tab-team" class="tab-content hidden fade-in">
                <div class="bg-gray-900 rounded-xl border border-gray-800">
                    <div class="px-6 py-4 border-b border-gray-800 flex items-center justify-between">
                        <div>
                            <h2 class="text-base font-semibold text-white">All Team Members</h2>
                            <p class="text-sm text-gray-500 mt-0.5">Manage your team subscriptions and access levels</p>
                        </div>
                        <div class="flex items-center gap-3">
                            <span id="team-count-badge" class="text-xs bg-gray-800 text-gray-400 px-3 py-1 rounded-full">5 members</span>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="text-left text-xs text-gray-500 uppercase tracking-wider border-b border-gray-800">
                                    <th class="px-6 py-3 font-medium">Member</th>
                                    <th class="px-6 py-3 font-medium">Role</th>
                                    <th class="px-6 py-3 font-medium">Plan</th>
                                    <th class="px-6 py-3 font-medium">Status</th>
                                    <th class="px-6 py-3 font-medium text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="team-table" class="divide-y divide-gray-800">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ==================== BILLING TAB ==================== -->
            <div id="tab-billing" class="tab-content hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                    <!-- Credits Card -->
                    <div class="bg-gradient-to-br from-indigo-600 to-violet-600 rounded-xl p-6 text-white">
                        <div class="text-sm text-indigo-200 mb-1">Account Credits</div>
                        <div id="billing-balance" class="text-4xl font-bold mb-4">$100</div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-indigo-200">Upgrade cost per seat</span>
                            <span class="font-semibold" id="billing-cost">$100</span>
                        </div>
                    </div>

                    <!-- Plan Info -->
                    <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
                        <div class="text-sm text-gray-500 mb-1">Current Plan</div>
                        <div class="text-2xl font-bold text-white mb-2">Team Plan</div>
                        <div class="text-sm text-gray-400">
                            <span id="billing-pro-count" class="text-amber-400 font-semibold">0</span> Pro seats &middot;
                            <span id="billing-free-count" class="font-semibold">5</span> Starter seats
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-800">
                            <div class="text-xs text-gray-500">Billing cycle</div>
                            <div class="text-sm text-gray-300">Monthly · Renews Mar 15, 2026</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
                        <div class="text-sm text-gray-500 mb-3">Quick Actions</div>
                        <div class="space-y-2">
                            <button onclick="resetSystem()" class="w-full flex items-center gap-3 px-4 py-2.5 rounded-lg bg-gray-800 hover:bg-gray-700 transition text-sm text-gray-300">
                                <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182"/></svg>
                                Reset Account Data
                            </button>
                            <a href="#" class="w-full flex items-center gap-3 px-4 py-2.5 rounded-lg bg-gray-800 hover:bg-gray-700 transition text-sm text-gray-300">
                                <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                Add Credits
                            </a>
                            <a href="#" class="w-full flex items-center gap-3 px-4 py-2.5 rounded-lg bg-gray-800 hover:bg-gray-700 transition text-sm text-gray-300">
                                <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/></svg>
                                Download Invoice
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Transaction History -->
                <div class="bg-gray-900 rounded-xl border border-gray-800">
                    <div class="px-6 py-4 border-b border-gray-800">
                        <h2 class="text-base font-semibold text-white">Transaction History</h2>
                        <p class="text-sm text-gray-500 mt-0.5">All billing activity and credit transactions</p>
                    </div>
                    <div id="billing-log" class="divide-y divide-gray-800 max-h-96 overflow-y-auto">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- ==================== ACTIVITY LOG TAB ==================== -->
            <div id="tab-activity" class="tab-content hidden fade-in">
                <div class="bg-gray-900 rounded-xl border border-gray-800">
                    <div class="px-6 py-4 border-b border-gray-800 flex items-center justify-between">
                        <div>
                            <h2 class="text-base font-semibold text-white">Activity Log</h2>
                            <p class="text-sm text-gray-500 mt-0.5">Complete audit trail of all system operations</p>
                        </div>
                        <span class="text-xs bg-green-500/10 text-green-400 px-3 py-1 rounded-full flex items-center gap-1.5">
                            <span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span>
                            Live
                        </span>
                    </div>
                    <div id="full-activity-log" class="divide-y divide-gray-800 max-h-[600px] overflow-y-auto">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- ==================== SETTINGS TAB ==================== -->
            <div id="tab-settings" class="tab-content hidden fade-in">
                <div class="max-w-2xl">
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 mb-6">
                        <h2 class="text-base font-semibold text-white mb-4">Organization</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-500 mb-1.5">Company Name</label>
                                <input type="text" value="TechCorp Ltd." class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-sm text-white focus:border-indigo-500 outline-none transition">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-500 mb-1.5">Billing Email</label>
                                <input type="email" value="billing@techcorp.io" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-sm text-white focus:border-indigo-500 outline-none transition">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-500 mb-1.5">Timezone</label>
                                <select class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-sm text-white focus:border-indigo-500 outline-none transition">
                                    <option>Asia/Jerusalem (UTC+2)</option>
                                    <option>America/New_York (UTC-5)</option>
                                    <option>Europe/London (UTC+0)</option>
                                </select>
                            </div>
                        </div>
                        <button class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition">
                            Save Changes
                        </button>
                    </div>

                    <div class="bg-gray-900 rounded-xl border border-red-900/50 p-6">
                        <h2 class="text-base font-semibold text-red-400 mb-2">Danger Zone</h2>
                        <p class="text-sm text-gray-500 mb-4">Reset all account data to default state. This will clear all upgrades and restore the initial credit balance.</p>
                        <button onclick="resetSystem()" class="bg-red-600 hover:bg-red-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition">
                            Reset All Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const REFRESH_INTERVAL = 1000;
        const avatarColors = ['#6366f1','#06b6d4','#f59e0b','#10b981','#ef4444','#8b5cf6','#ec4899'];
        let currentTab = 'overview';

        // ===== TAB SWITCHING =====
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`tab-${tab}`).classList.remove('hidden');
            document.querySelectorAll('[data-tab]').forEach(el => el.classList.remove('active'));
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            currentTab = tab;
            const titles = {
                overview: ['Overview', 'Monitor your team and account in real-time'],
                team: ['Team Members', 'Manage subscriptions and access levels'],
                billing: ['Billing & Credits', 'Account balance, transactions, and invoices'],
                activity: ['Activity Log', 'Complete audit trail of all operations'],
                settings: ['Settings', 'Organization configuration and preferences']
            };
            document.getElementById('page-title').textContent = titles[tab][0];
            document.getElementById('page-subtitle').textContent = titles[tab][1];
        }

        // ===== TOAST NOTIFICATIONS =====
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const colors = { success: 'bg-emerald-600', error: 'bg-red-600', info: 'bg-indigo-600' };
            const icons = {
                success: '<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"/></svg>',
                error: '<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>',
                info: '<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"/></svg>'
            };
            toast.className = `toast-enter flex items-center gap-3 ${colors[type]} text-white px-5 py-3 rounded-xl shadow-2xl text-sm font-medium`;
            toast.innerHTML = `${icons[type]}<span>${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => { toast.classList.remove('toast-enter'); toast.classList.add('toast-exit'); setTimeout(() => toast.remove(), 300); }, 3000);
        }

        // ===== DATA FETCHING =====
        async function fetchStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                updateDashboard(data);
            } catch (error) {
                console.error('Error fetching stats:', error);
            }
        }

        // ===== DASHBOARD UPDATE =====
        function updateDashboard(data) {
            const balance = data.wallet.balance;
            const balanceStr = `$${balance.toFixed(0)}`;

            // Stats cards
            const creditsEl = document.getElementById('credits-balance');
            creditsEl.textContent = balanceStr;
            creditsEl.className = 'text-3xl font-bold ' + (balance < 0 ? 'balance-negative' : balance < data.config.upgrade_cost ? 'balance-warning' : 'balance-ok');

            document.getElementById('total-members').textContent = data.stats.total;
            document.getElementById('pro-count').textContent = data.stats.premium;
            document.getElementById('free-count').textContent = data.stats.free;

            // Billing tab
            document.getElementById('billing-balance').textContent = `$${balance.toFixed(2)}`;
            document.getElementById('billing-cost').textContent = `$${data.config.upgrade_cost}`;
            document.getElementById('billing-pro-count').textContent = data.stats.premium;
            document.getElementById('billing-free-count').textContent = data.stats.free;
            document.getElementById('team-count-badge').textContent = `${data.stats.total} members`;

            // Team preview (overview)
            updateTeamPreview(data.users);
            // Team table (team tab)
            updateTeamTable(data.users);
            // Activity
            updateActivityPreview(data.logs);
            updateFullActivityLog(data.logs);
            updateBillingLog(data.logs);
        }

        function getInitials(name) {
            return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
        }

        function getAvatarColor(id) {
            return avatarColors[(id - 1) % avatarColors.length];
        }

        // ===== TEAM PREVIEW (Overview Tab) =====
        function updateTeamPreview(users) {
            const el = document.getElementById('team-preview');
            if (!users.length) { el.innerHTML = '<div class="px-6 py-8 text-center text-gray-500">No team members</div>'; return; }
            el.innerHTML = users.map(u => `
                <div class="flex items-center justify-between px-6 py-3.5 hover:bg-gray-800/50 transition">
                    <div class="flex items-center gap-3">
                        <div class="w-9 h-9 rounded-full flex items-center justify-center text-white text-xs font-bold" style="background:${getAvatarColor(u.id)}">${getInitials(u.name)}</div>
                        <div>
                            <div class="text-sm font-medium text-white">${u.name}</div>
                            <div class="text-xs text-gray-500">${u.email || u.role || 'Member'}</div>
                        </div>
                    </div>
                    <span class="px-2.5 py-1 rounded-full text-xs font-medium ${u.is_premium ? 'bg-amber-500/10 text-amber-400 border border-amber-500/20' : 'bg-gray-800 text-gray-400 border border-gray-700'}">
                        ${u.is_premium ? 'Pro' : 'Starter'}
                    </span>
                </div>
            `).join('');
        }

        // ===== TEAM TABLE (Team Tab) =====
        function updateTeamTable(users) {
            const el = document.getElementById('team-table');
            el.innerHTML = users.map(u => `
                <tr class="hover:bg-gray-800/50 transition">
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold" style="background:${getAvatarColor(u.id)}">${getInitials(u.name)}</div>
                            <div>
                                <div class="text-sm font-medium text-white">${u.name}</div>
                                <div class="text-xs text-gray-500">${u.email || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-400">${u.role || 'Member'}</td>
                    <td class="px-6 py-4">
                        <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${u.is_premium ? 'bg-amber-500/10 text-amber-400 border border-amber-500/20' : 'bg-gray-800 text-gray-400 border border-gray-700'}">
                            ${u.is_premium ? '<svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg> Pro' : 'Starter'}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <span class="inline-flex items-center gap-1.5 text-xs ${u.is_premium ? 'text-emerald-400' : 'text-gray-500'}">
                            <span class="w-1.5 h-1.5 rounded-full ${u.is_premium ? 'bg-emerald-400' : 'bg-gray-600'}"></span>
                            ${u.is_premium ? 'Active' : 'Free tier'}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-right">
                        ${!u.is_premium
                            ? `<button onclick="upgradeUser(${u.id}, this)" class="upgrade-btn bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-xs font-medium transition shadow-lg shadow-indigo-500/20">Upgrade to Pro</button>`
                            : '<span class="text-xs text-gray-600">—</span>'}
                    </td>
                </tr>
            `).join('');
        }

        // ===== ACTIVITY PREVIEW (Overview Tab) =====
        function updateActivityPreview(logs) {
            const el = document.getElementById('activity-preview');
            if (!logs.length) { el.innerHTML = '<div class="px-6 py-8 text-center text-gray-500 text-sm">No activity yet</div>'; return; }
            el.innerHTML = logs.slice(0, 8).map(log => {
                const isSuccess = log.status === 'SUCCESS';
                return `
                    <div class="px-6 py-3 hover:bg-gray-800/50 transition">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="w-2 h-2 rounded-full ${isSuccess ? 'bg-emerald-400' : 'bg-gray-600'}"></span>
                            <span class="text-xs font-medium ${isSuccess ? 'text-emerald-400' : 'text-gray-500'}">${isSuccess ? 'Upgrade' : 'Rejected'}</span>
                            <span class="text-xs text-gray-600 ml-auto">${log.thread_id || ''}</span>
                        </div>
                        <div class="text-xs text-gray-500">User ${log.user_id} · $${log.balance_before} → $${log.balance_after}</div>
                    </div>
                `;
            }).join('');
        }

        // ===== FULL ACTIVITY LOG (Activity Tab) =====
        function updateFullActivityLog(logs) {
            const el = document.getElementById('full-activity-log');
            if (!logs.length) { el.innerHTML = '<div class="px-6 py-12 text-center text-gray-500">No activity recorded yet</div>'; return; }
            el.innerHTML = logs.map(log => {
                const isSuccess = log.status === 'SUCCESS';
                const isSecure = (log.action || '').includes('SECURE');
                return `
                    <div class="px-6 py-4 hover:bg-gray-800/50 transition">
                        <div class="flex items-center justify-between mb-1.5">
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full ${isSuccess ? (isSecure ? 'bg-blue-400' : 'bg-emerald-400') : 'bg-red-400'}"></span>
                                <span class="text-sm font-medium text-white">${log.action}</span>
                            </div>
                            <span class="text-xs text-gray-600 font-mono">${log.thread_id || ''}</span>
                        </div>
                        <div class="flex items-center gap-4 text-xs text-gray-500">
                            <span>User ID: ${log.user_id}</span>
                            <span>Balance: $${log.balance_before} → $${log.balance_after}</span>
                            <span class="px-2 py-0.5 rounded text-xs ${isSuccess ? 'bg-emerald-500/10 text-emerald-400' : 'bg-red-500/10 text-red-400'}">${log.status}</span>
                        </div>
                        <div class="text-xs text-gray-600 mt-1">${log.timestamp || ''}</div>
                    </div>
                `;
            }).join('');
        }

        // ===== BILLING LOG =====
        function updateBillingLog(logs) {
            const el = document.getElementById('billing-log');
            if (!logs.length) { el.innerHTML = '<div class="px-6 py-12 text-center text-gray-500">No transactions yet</div>'; return; }
            el.innerHTML = logs.map(log => {
                const isSuccess = log.status === 'SUCCESS';
                return `
                    <div class="px-6 py-4 hover:bg-gray-800/50 transition flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg ${isSuccess ? 'bg-emerald-500/10' : 'bg-red-500/10'} flex items-center justify-center">
                                ${isSuccess
                                    ? '<svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"/></svg>'
                                    : '<svg class="w-4 h-4 text-red-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>'}
                            </div>
                            <div>
                                <div class="text-sm text-white">${isSuccess ? 'Pro Upgrade' : 'Upgrade Rejected'} — User ${log.user_id}</div>
                                <div class="text-xs text-gray-500">${log.timestamp || ''}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-medium ${isSuccess ? 'text-red-400' : 'text-gray-500'}">${isSuccess ? '-$100' : '$0'}</div>
                            <div class="text-xs text-gray-500">${log.thread_id || ''}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ===== UPGRADE USER =====
        async function upgradeUser(userId, btnEl) {
            if (btnEl) { btnEl.disabled = true; btnEl.textContent = 'Processing...'; }
            try {
                const response = await fetch('/api/upgrade', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: userId })
                });
                const data = await response.json();
                if (data.success) {
                    showToast(`User upgraded to Pro successfully!`, 'success');
                } else {
                    showToast(data.error || 'Insufficient credits for upgrade', 'error');
                }
                fetchStats();
            } catch (error) {
                showToast('Connection error. Please try again.', 'error');
            }
            if (btnEl) { btnEl.disabled = false; btnEl.textContent = 'Upgrade to Pro'; }
        }

        // ===== RESET SYSTEM =====
        async function resetSystem() {
            try {
                await fetch('/api/reset', { method: 'POST' });
                showToast('Account data has been reset', 'info');
                fetchStats();
            } catch (error) {
                showToast('Error resetting data', 'error');
            }
        }

        // ===== INIT =====
        fetchStats();
        setInterval(fetchStats, REFRESH_INTERVAL);
    </script>
</body>
</html>
